import{r as B}from"./vue-advanced-chat.es-CvazeTci.js";import{l as R}from"./index-Rnf9BJUB.js";import{n as w,p as S,M as F,v as N,r as m,x as P,y as c,z as C,A as D,s as J,B as T,C as z,E as $,O as L,a as t,P as U,Q as O,m as j,u as E,K as A,R as H,c as K,k as h,e as Q,i as q,w as i,F as G,o as y,g as W}from"./index-Cr31RzsN.js";import{b as k}from"./route-block-B_A1xBdJ.js";import{a as X,m as Y,V as p}from"./forwardRefs-KmNTgken.js";import{k as Z,M as ee}from"./index-CgakURYh.js";import{V as ae}from"./VNavigationDrawer-7LtAG5Nl.js";import{V as oe,a as te,b as se}from"./VCard-93p4KZ-E.js";import{V as re}from"./VForm-CBwy0kI3.js";import{V as _}from"./VTextField-DFbaMT9j.js";import{a as ne}from"./scopeId-CPYDgJwB.js";import{V as le}from"./VList-DCcsJhVN.js";import{V as ue}from"./VToolbar-DRYgdlfw.js";const ie=S({app:Boolean,appear:Boolean,extended:Boolean,layout:Boolean,offset:Boolean,modelValue:{type:Boolean,default:!0},...L(Y({active:!0}),["location"]),...$(),...X(),...Z({transition:"fab-transition"})},"VFab"),me=w()({name:"VFab",props:ie(),emits:{"update:modelValue":e=>!0},setup(e,V){let{slots:d}=V;const f=F(e,"modelValue"),v=N(56),r=m(),{resizeRef:g}=P(s=>{s.length&&(v.value=s[0].target.clientHeight)}),u=c(()=>e.app||e.absolute),l=c(()=>{var s;return u.value?((s=e.location)==null?void 0:s.split(" ").shift())??"bottom":!1}),I=c(()=>{var s;return u.value?((s=e.location)==null?void 0:s.split(" ")[1])??"end":!1});C(()=>e.app,()=>{const s=D({id:e.name,order:c(()=>parseInt(e.order,10)),position:l,layoutSize:c(()=>e.layout?v.value+24:0),elementSize:c(()=>v.value+24),active:c(()=>e.app&&f.value),absolute:J(e,"absolute")});T(()=>{r.value=s.layoutItemStyles.value})});const b=m();return z(()=>{const s=p.filterProps(e);return t("div",{ref:b,class:["v-fab",{"v-fab--absolute":e.absolute,"v-fab--app":!!e.app,"v-fab--extended":e.extended,"v-fab--offset":e.offset,[`v-fab--${l.value}`]:u.value,[`v-fab--${I.value}`]:u.value},e.class],style:[e.app?{...r.value}:{height:e.absolute?"100%":"inherit"},e.style]},[t("div",{class:"v-fab__container"},[t(ee,{appear:e.appear,transition:e.transition},{default:()=>[U(t(p,j({ref:g},s,{active:void 0,location:void 0}),d),[[O,e.active]])]})])])}),{}}}),de={class:"h-100"},ce=["current-user-id","rooms","messages","messages-loaded"],fe={__name:"chatroom",setup(e){B();const V=E(),d=m(!1),f=m(V.userId);console.log("currentUserId:",f.value);const v=m([{roomId:"1",roomName:"Room 1",avatar:"https://66.media.tumblr.com/avatar_c6a8eae4303e_512.pnj",users:[{_id:"1234",username:"John Doe"},{_id:"4321",username:"John Snow"}]},{roomId:"2",roomName:"Room 2",avatar:"https://66.media.tumblr.com/avatar_c6a8eae4303e_512.pnj",users:[{_id:"1234",username:"John Doe"},{_id:"4321",username:"John Snow"}]}]),r=m([]),g=m(!1);let u=m("1"),l=null;l=R("https://manabee-back.onrender.com"),l.on("receiveMessage",a=>{console.log("message.roomId:",a.roomId),console.log("currentRoomId:",u.value),a.roomId===u.value&&r.value.push(a)});function I(a={}){console.log("options:",a),console.log("fetchMessages:socket: ",l),u.value=a.room.roomId,l.emit("joinRoom",a.room.roomId),r.value.splice(0),a.reset?r.value=s(!0,a.room.roomId):(r.value=[...s(!1,a.room.roomId),...r.value],g.value=!0)}const b=[{roomId:"1",messages:[{_id:0,content:"room1 的開頭 0",senderId:"4321",username:"John Doe",date:"13 November",timestamp:"10:20"}]},{roomId:"2",messages:[{_id:0,content:"room2 的開頭 0",senderId:"4321",username:"John Doe",date:"13 November",timestamp:"10:20"}]}];function s(a,o){const n=[];return n.push(...b.find(M=>M.roomId===o).messages),n}function x(a){console.log("message:",a),console.log("message.value:",r.value),l.emit("sendMessage",{roomId:a.roomId,_id:r.value.length,content:a.content,senderId:f.value}),console.log(b)}return A(()=>{}),H(()=>{l.disconnect()}),(a,o)=>(y(),K(G,null,[h("div",de,[h("vue-advanced-chat",{height:"100%","current-user-id":f.value,rooms:JSON.stringify(v.value),"load-first-room":!1,"rooms-loaded":!0,messages:JSON.stringify(r.value),"messages-loaded":g.value,"dark-mode":"",onSendMessage:o[0]||(o[0]=n=>x(n.detail[0])),onFetchMessages:o[1]||(o[1]=n=>I(n.detail[0]))},null,40,ce)]),d.value?q("",!0):(y(),Q(me,{key:0,absolute:!1,app:!0,color:"secondary",location:"right top",size:"large",icon:"mdi-text",variant:"text",class:"mt-n2",onClick:o[2]||(o[2]=n=>d.value=!0)})),t(ae,{modelValue:d.value,"onUpdate:modelValue":o[4]||(o[4]=n=>d.value=n),location:"end"},{prepend:i(()=>[t(ue,{color:"gray"},{default:i(()=>[t(p,{icon:"mdi-arrow-right",variant:"text",onClick:o[3]||(o[3]=n=>d.value=!1)}),o[5]||(o[5]=h("span",{class:"text-h5"},"交換設定",-1))]),_:1})]),append:i(()=>[t(p,{block:"",color:"success",class:"rounded-0",flat:"",size:"x-large"},{default:i(()=>o[6]||(o[6]=[W("開始交換")])),_:1})]),default:i(()=>[t(oe,{flat:""},{default:i(()=>[t(te),t(se,null,{default:i(()=>[t(re,null,{default:i(()=>[t(_,{variant:"outlined",label:"交換頻率",flat:""}),t(_,{variant:"outlined",label:"交換結束日期",flat:""})]),_:1})]),_:1})]),_:1}),t(ne),t(le,{density:"compact",nav:""})]),_:1},8,["modelValue"])],64))}};typeof k=="function"&&k(fe);export{fe as default};
